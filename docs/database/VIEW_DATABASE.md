# üìä –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –¥–∞–Ω–Ω—ã—Ö –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î

```bash
python scripts/tools/view_db_structure.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –°—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã (–∫–æ–ª–æ–Ω–∫–∏, —Ç–∏–ø—ã, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)
- –ò–Ω–¥–µ–∫—Å—ã –∏ –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏
- –ü–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î

```bash
python scripts/tools/view_db_data.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ë–î
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏ –Ω–∞ –∞–Ω–∞–ª–∏–∑
- –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 3 –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

### 1. `review_tasks` - –ó–∞–¥–∞—á–∏ –Ω–∞ –∞–Ω–∞–ª–∏–∑

–•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–¥–∞—á–∞—Ö –Ω–∞ –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

**–ö–æ–ª–æ–Ω–∫–∏:**
- `id` (UUID) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–¥–∞—á–∏
- `document` (TEXT) - –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- `document_type` (VARCHAR) - –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ (markdown, text, etc.)
- `context` (JSON) - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- `status` (VARCHAR) - –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ (pending, in_progress, completed, failed)
- `user_email` (VARCHAR) - Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `created_at` (DATETIME) - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` (DATETIME) - –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 2. `issues` - –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

–•—Ä–∞–Ω–∏—Ç –ø—Ä–æ–±–ª–µ–º—ã, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç–∞–º–∏ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ.

**–ö–æ–ª–æ–Ω–∫–∏:**
- `id` (UUID) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã
- `task_id` (UUID) - –°—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–¥–∞—á—É
- `agent` (VARCHAR) - –ê–≥–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—à–µ–ª –ø—Ä–æ–±–ª–µ–º—É (analyst, architect, devsecops, devops_sre)
- `priority` (VARCHAR) - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç (critical, high, medium, low, info)
- `title` (VARCHAR) - –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ–±–ª–µ–º—ã
- `description` (TEXT) - –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- `recommendation` (TEXT) - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é
- `category` (VARCHAR) - –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–æ–±–ª–µ–º—ã
- `location` (VARCHAR) - –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `metadata` (JSON) - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- `created_at` (DATETIME) - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è

### 3. `review_results` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞

–•—Ä–∞–Ω–∏—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞.

**–ö–æ–ª–æ–Ω–∫–∏:**
- `id` (UUID) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- `task_id` (UUID) - –°—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–¥–∞—á—É (—É–Ω–∏–∫–∞–ª—å–Ω–æ)
- `status` (VARCHAR) - –°—Ç–∞—Ç—É—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- `summary` (TEXT) - –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –∞–Ω–∞–ª–∏–∑–∞
- `report_markdown` (TEXT) - –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown
- `report_json` (JSON) - –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
- `quality_score` (FLOAT) - –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `created_at` (DATETIME) - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è

---

## üîç –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã

```bash
python scripts/tools/view_db_structure.py
```

**–í—ã–≤–æ–¥:**
```
======================================================================
–°–¢–†–£–ö–¢–£–†–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•
======================================================================

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: localhost:5432/docreview
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —É—Å–ø–µ—à–Ω–æ

–ù–∞–π–¥–µ–Ω–æ —Ç–∞–±–ª–∏—Ü –≤ –ë–î: 3
–¢–∞–±–ª–∏—Ü—ã: review_tasks, issues, review_results

======================================================================
–¢–∞–±–ª–∏—Ü–∞: review_tasks
======================================================================

–ö–æ–ª–æ–Ω–∫–∏ (8):
----------------------------------------------------------------------
–ò–º—è                           –¢–∏–ø                       Nullable   Default        
----------------------------------------------------------------------
id                            UUID                      NO         auto            
document                      TEXT                      NO         -              
document_type                 VARCHAR(50)               YES        -              
context                       JSON                      YES        -              
status                        VARCHAR(20)               YES        -              
user_email                    VARCHAR(255)              YES        -              
created_at                    DATETIME                  YES        function        
updated_at                    DATETIME                  YES        function        

–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á: id
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö

```bash
python scripts/tools/view_db_data.py
```

**–í—ã–≤–æ–¥:**
```
======================================================================
–î–ê–ù–ù–´–ï –ò–ó –ë–ê–ó–´ –î–ê–ù–ù–´–•
======================================================================

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: localhost:5432/docreview
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —É—Å–ø–µ—à–Ω–æ

======================================================================
–°–¢–ê–¢–ò–°–¢–ò–ö–ê
======================================================================

–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
  –ó–∞–¥–∞—á –Ω–∞ –∞–Ω–∞–ª–∏–∑: 5
  –ù–∞–π–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º: 12
  –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞: 3

–ó–∞–¥–∞—á–∏ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º:
  completed: 3
  in_progress: 1
  pending: 1

======================================================================
–ó–ê–î–ê–ß–ò –ù–ê –ê–ù–ê–õ–ò–ó (review_tasks)
======================================================================

–ù–∞–π–¥–µ–Ω–æ –∑–∞–¥–∞—á: 5 (–ø–æ–∫–∞–∑–∞–Ω–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10)

[1] –ó–∞–¥–∞—á–∞ ID: 550e8400-e29b-41d4-a716-446655440000
    –°—Ç–∞—Ç—É—Å: completed
    –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞: markdown
    Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: user@example.com
    –°–æ–∑–¥–∞–Ω–æ: 2024-12-07 10:30:00
    –û–±–Ω–æ–≤–ª–µ–Ω–æ: 2024-12-07 10:35:00
    –î–æ–∫—É–º–µ–Ω—Ç (–ø–µ—Ä–≤—ã–µ 100 —Å–∏–º–≤–æ–ª–æ–≤): # –ú–æ—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è\n\n## –†–∞–∑–¥–µ–ª 1\n\n–¢–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏...
```

---

## üõ†Ô∏è –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã

### –ß–µ—Ä–µ–∑ psql (PostgreSQL CLI)

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
psql -h localhost -U postgres -d docreview

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü
\dt

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã
\d review_tasks

# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
SELECT * FROM review_tasks LIMIT 10;
```

### –ß–µ—Ä–µ–∑ Python –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ

```python
from src.db.session import SessionLocal
from src.db.models import ReviewTaskDB

db = SessionLocal()
tasks = db.query(ReviewTaskDB).all()
for task in tasks:
    print(f"Task {task.id}: {task.status}")
db.close()
```

---

## üìö –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [README.md](README.md) - –û–±–∑–æ—Ä —Ä–∞–±–æ—Ç—ã —Å –ë–î
- [ADDING_FIELD.md](ADDING_FIELD.md) - –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ
- [EXAMPLE_USER_EMAIL.md](EXAMPLE_USER_EMAIL.md) - –ü—Ä–∏–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### –û—à–∏–±–∫–∞: "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î"

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env`:
   ```env
   DATABASE_URL=postgresql://postgres:postgres@localhost:5432/docreview
   ```
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞:
   ```bash
   createdb docreview
   ```

### –û—à–∏–±–∫–∞: "–¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"

**–†–µ—à–µ–Ω–∏–µ:**
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ë–î:
```bash
# –ß–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
python scripts/init_db.py
```

### –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É?

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `view_db_data.py` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –µ–≥–æ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ psql:

```sql
SELECT * FROM review_tasks WHERE status = 'completed';
```

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –¥–∞–Ω–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö! üéâ

